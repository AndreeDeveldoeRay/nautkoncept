<section id=section_video>
{% for post in site.posts %}
<article>


    {% if post.vimeo-embed %} <div class="video_container">{{ post.vimeo-embed }}</div> {% endif %}

    {% if post.yt-video-id %} <div class="videoWrapper"><div id=player></div> </div> {% endif %}

    <!-- <h1 class="page_title">
        {{ post.title }}
    </h1>
    <div class="post_content">
        {{ post.content }}
    </div> -->



</article>



<style>
.videoWrapper {
	position: relative;
	padding-bottom: 56.25%; /* 16:9 */
	padding-top: 0px;
	height: 0;
}
.videoWrapper iframe {
	position: absolute;
	top: 0;
	left: 0;
	width: 100%;
	height: 100%;
}
</style>

<script>
      // 2. This code loads the IFrame Player API code asynchronously.
      var tag = document.createElement('script');

      tag.src = "https://www.youtube.com/iframe_api";
      var firstScriptTag = document.getElementsByTagName('script')[0];
      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

      // 3. This function creates an <iframe> (and YouTube player) after the API code downloads.
      var player;

      function onYouTubeIframeAPIReady() {
        player = new YT.Player('player', {
          height: '349',
          width: '560',
          videoId: '{{ post.yt-video-id }}',
          suggestedQuality: 'highres',
          playerVars: {
            controls: 0,
            disablekb: 1,
            showinfo: 0
        },
          events: {
            'onReady': onPlayerReady,
            'onStateChange': onPlayerStateChange
          }
        });
      }



      // 4. The API will call this function when the video player is ready.
      function onPlayerReady(event) {
        // event.target.playVideo();
      }

      // 5. The API calls this function when the player's state changes.
      //    The function indicates that when playing a video (state=1),
      //    the player should play for six seconds and then stop.
      var done = false;
      function onPlayerStateChange(event) {
          if (event.data == 1){             // playing
              $.when($("#loader_stage")
                  .delay(0)
                  .fadeOut(300))
                  .done(function() {
                      $('body').css('overflow', 'auto')
                      $('body').unbind('touchmove')
              })
          }
          if (event.data == 0){
              player.seekTo(0)
              player.stopVideo()
          }
      }
      function stopVideo() {
        player.stopVideo();
        $("#player").fadeOut(300)
      }
    </script>

{% endfor %}
</section>
